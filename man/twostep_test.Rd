% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/twostep.R
\name{twostep_test}
\alias{twostep_test}
\title{Two-step test for predictive biomarkers with a zero spike}
\usage{
twostep_test(
  y,
  trt,
  x,
  nperm = 1000,
  combine = c("fisher", "brown"),
  brown_nbrown = 200,
  min_pos = 5,
  seed = NULL
)
}
\arguments{
\item{y}{Numeric outcome vector (length N).}

\item{trt}{Integer or logical treatment indicator (0/1; length N).}

\item{x}{Numeric biomarker (length N), allowed to be zero-inflated.}

\item{nperm}{Integer. Number of random permutations for the reference
distributions in Part A and Part B. Default 1000.}

\item{combine}{Character. "fisher" (default) or "brown".}

\item{brown_nbrown}{Integer. When \code{combine = "brown"}, the correlation
adjustment is estimated by a light null-permutation scheme with this
many replicates (default 200). Set to 0 to skip and default to Fisher.}

\item{min_pos}{Integer. Minimum number of positive-biomarker subjects
required to run Part B (default 5). If fewer, Part B returns p=1.}

\item{seed}{Optional integer for reproducibility.}
}
\value{
A list with elements \itemize{
\item \code{pA} – Part A p-value (spike test).
\item \code{pB} – Part B p-value (tail scan).
\item \code{p_combined} – combined p-value by Fisher or Brown.
\item \code{method} – combination method used.
\item \code{details} – list with auxiliary information.
}
}
\description{
Implements the two-step permutation test used in your simulations:
Part A targets the spike stratum (X = 0); Part B is the AKSA-style
tail scan over the positive biomarker values (X > 0). The two p-values
are combined by Fisher or Brown.
}
